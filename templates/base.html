{% load static %}
{% block title %}Sign Up | TaskNest{% endblock %}

{% block content %}
<div class="container py-5">
  <div class="container-sm">
    <div class="card">
      <div class="card-header bg-primary">
        <h3 style="margin: 0; color: white;">
          <i class="fas fa-user-plus"></i> Create Your Account
        </h3>
      </div>
      <div class="card-body">
        <form method="POST" id="signupForm">
          {% csrf_token %}
          
          <!-- Username -->
          <div class="form-group">
            <label for="id_username" class="form-label">Username *</label>
            {{ form.username }}
            {% if form.username.errors %}
              <div class="text-danger">{{ form.username.errors }}</div>
            {% endif %}
          </div>

          <!-- First Name -->
          <div class="form-group">
            <label for="id_first_name" class="form-label">First Name *</label>
            {{ form.first_name }}
            {% if form.first_name.errors %}
              <div class="text-danger">{{ form.first_name.errors }}</div>
            {% endif %}
          </div>

          <!-- Last Name -->
          <div class="form-group">
            <label for="id_last_name" class="form-label">Last Name *</label>
            {{ form.last_name }}
            {% if form.last_name.errors %}
              <div class="text-danger">{{ form.last_name.errors }}</div>
            {% endif %}
          </div>

          <!-- Email -->
          <div class="form-group">
            <label for="id_email" class="form-label">Email Address *</label>
            {{ form.email }}
            {% if form.email.errors %}
              <div class="text-danger">{{ form.email.errors }}</div>
            {% endif %}
          </div>

          <!-- Title -->
          <div class="form-group">
            <label for="id_title" class="form-label">Title</label>
            {{ form.title }}
          </div>

          <!-- Role Selection -->
          <div class="form-group">
            <label for="id_role" class="form-label">I am a *</label>
            <select name="role" id="id_role" class="form-select" required onchange="toggleOccupationField()">
              <option value="">-- Select Role --</option>
              <option value="customer">Customer (Looking for tradesmen)</option>
              <option value="tradesman">Tradesman (Offering services)</option>
            </select>
            {% if form.role.errors %}
              <div class="text-danger">{{ form.role.errors }}</div>
            {% endif %}
          </div>

          <!-- Current Occupation (Only for Tradesman) -->
          <div class="form-group" id="occupationField" style="display: none;">
            <label for="id_current_occupation" class="form-label">Trade/Occupation *</label>
            <select name="current_occupation" id="id_current_occupation" class="form-select">
              <option value="">-- Select Your Trade --</option>
              <option value="Electrician">Electrician</option>
              <option value="Plumber">Plumber</option>
              <option value="Carpenter">Carpenter</option>
              <option value="Painter & Decorator">Painter & Decorator</option>
              <option value="Builder">Builder</option>
              <option value="Roofer">Roofer</option>
              <option value="Landscaper">Landscaper</option>
              <option value="Plasterer">Plasterer</option>
              <option value="Tiler">Tiler</option>
              <option value="Heating Engineer">Heating Engineer</option>
              <option value="Locksmith">Locksmith</option>
              <option value="Glazier">Glazier</option>
              <option value="Other">Other</option>
            </select>
          </div>

          <!-- Password -->
          <div class="form-group">
            <label for="id_password1" class="form-label">Password *</label>
            <div style="position: relative;">
              {{ form.password1 }}
              <button type="button" onclick="togglePassword('id_password1', this)" 
                      style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-secondary);">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            {% if form.password1.errors %}
              <div class="text-danger">{{ form.password1.errors }}</div>
            {% endif %}
            <small class="text-muted">Must be at least 8 characters</small>
          </div>

          <!-- Confirm Password -->
          <div class="form-group">
            <label for="id_password2" class="form-label">Confirm Password *</label>
            <div style="position: relative;">
              {{ form.password2 }}
              <button type="button" onclick="togglePassword('id_password2', this)" 
                      style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; color: var(--text-secondary);">
                <i class="fas fa-eye"></i>
              </button>
            </div>
            {% if form.password2.errors %}
              <div class="text-danger">{{ form.password2.errors }}</div>
            {% endif %}
          </div>

          <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: var(--space-4);">
            <i class="fas fa-user-plus"></i> Create Account
          </button>
        </form>

        <p class="text-center mt-4">
          Already have an account? <a href="{% url 'login' %}">Login here</a>
        </p>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block extra_js %}
<script src="{% static 'core/js/auth.js' %}"></script>
<script src="{% static 'core/js/main.js' %}"></script>
{% endblock %}